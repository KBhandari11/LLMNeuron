2023-11-21 12:41:02 - INFO :       
********************************************************************************************************************************************************************************************************

2023-11-21 12:41:02 - INFO :       DATASET: commonsense_qa
Single
Index 0
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.48s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.65s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.77s/it]
2023-11-21 12:41:08 - INFO :       Use taylor pruner...
2023-11-21 12:41:17 - INFO :       Start Pruning
******************************
Loading Dataset
Map (num_proc=10):   0%|          | 0/9741 [00:00<?, ? examples/s]Map (num_proc=10):   3%|▎         | 339/9741 [00:00<00:07, 1342.90 examples/s]Map (num_proc=10):  32%|███▏      | 3160/9741 [00:00<00:00, 10680.32 examples/s]Map (num_proc=10):  49%|████▊     | 4745/9741 [00:00<00:00, 9009.63 examples/s] Map (num_proc=10):  67%|██████▋   | 6525/9741 [00:00<00:00, 10938.81 examples/s]Map (num_proc=10):  84%|████████▍ | 8181/9741 [00:00<00:00, 12414.07 examples/s]Map (num_proc=10): 100%|██████████| 9741/9741 [00:00<00:00, 12826.74 examples/s]Map (num_proc=10): 100%|██████████| 9741/9741 [00:01<00:00, 8046.00 examples/s] 
Map (num_proc=10):   0%|          | 0/1221 [00:00<?, ? examples/s]Map (num_proc=10):   9%|▉         | 115/1221 [00:00<00:04, 252.23 examples/s]Map (num_proc=10):  99%|█████████▉| 1207/1221 [00:00<00:00, 2744.11 examples/s]Map (num_proc=10): 100%|██████████| 1221/1221 [00:00<00:00, 1411.90 examples/s]
2023-11-21 12:41:25 - INFO :       Start Backwarding in iterative steps = 0...
2023-11-21 12:45:53 - INFO :       Loss = 17.404579162597656
2023-11-21 12:53:29 - INFO :       After Iter 1/1, #parameters: 5726666201
2023-11-21 12:53:29 - INFO :       #Param before: 6738415616, #Param after: 5726666201, Ratio = 84.9854%
2023-11-21 12:53:47 - INFO :       commonsense_qa: Total Sparsity 1.3491032299879584e-06
2023-11-21 12:53:47 - INFO :       
==================Finish================

2023-11-21 12:53:47 - INFO :       Memory Requirement: 0.0 MiB

2023-11-21 12:53:47 - INFO :       
********************************************************************************************************************************************************************************************************

2023-11-21 12:53:47 - INFO :       DATASET: tasksource/bigbench abstract_narrative_understanding
******************************
Generating Samples
******************************
Prepare Validation Dataset
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [06:51<06:51, 411.04s/it]Loading checkpoint shards: 100%|██████████| 2/2 [06:55<00:00, 172.13s/it]Loading checkpoint shards: 100%|██████████| 2/2 [06:55<00:00, 207.96s/it]
2023-11-21 13:00:49 - INFO :       Use taylor pruner...
2023-11-21 13:00:56 - INFO :       Start Pruning
******************************
Loading Dataset
Map (num_proc=10):   0%|          | 0/2400 [00:00<?, ? examples/s]Map (num_proc=10):   0%|          | 1/2400 [00:08<5:40:10,  8.51s/ examples]Map (num_proc=10):   1%|          | 17/2400 [00:08<14:31,  2.73 examples/s] Map (num_proc=10):   6%|▌         | 132/2400 [00:08<01:19, 28.41 examples/s]Map (num_proc=10):  16%|█▌        | 386/2400 [00:11<00:33, 60.69 examples/s]Map (num_proc=10):  36%|███▋      | 870/2400 [00:17<00:20, 73.90 examples/s]Map (num_proc=10):  90%|█████████ | 2164/2400 [00:20<00:01, 186.12 examples/s]Map (num_proc=10):  98%|█████████▊| 2345/2400 [00:20<00:00, 205.00 examples/s]Map (num_proc=10): 100%|██████████| 2400/2400 [00:22<00:00, 107.57 examples/s]
Map (num_proc=10):   0%|          | 0/600 [00:00<?, ? examples/s]Map (num_proc=10):  10%|█         | 60/600 [00:01<00:14, 37.12 examples/s]Map (num_proc=10): 100%|██████████| 600/600 [00:03<00:00, 161.46 examples/s]
2023-11-21 13:02:38 - INFO :       Start Backwarding in iterative steps = 0...
2023-11-21 13:05:52 - INFO :       Loss = 8.90291976928711
2023-11-21 13:12:27 - INFO :       After Iter 1/1, #parameters: 5726666201
2023-11-21 13:12:27 - INFO :       #Param before: 6738415616, #Param after: 5726666201, Ratio = 84.9854%
2023-11-21 13:12:43 - INFO :       abstract_narrative_understanding: Total Sparsity 1.354735849534036e-06
2023-11-21 13:12:43 - INFO :       
==================Finish================

2023-11-21 13:12:43 - INFO :       Memory Requirement: 0.0 MiB

2023-11-21 13:12:43 - INFO :       
********************************************************************************************************************************************************************************************************

2023-11-21 13:12:43 - INFO :       DATASET: tasksource/bigbench anachronisms
******************************
Generating Samples
******************************
Prepare Validation Dataset
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:16<00:16, 16.51s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:17<00:00,  7.53s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:17<00:00,  8.87s/it]
2023-11-21 13:13:05 - INFO :       Use taylor pruner...
2023-11-21 13:13:09 - INFO :       Start Pruning
******************************
Loading Dataset
Map (num_proc=10):   0%|          | 0/184 [00:00<?, ? examples/s]Map (num_proc=10):   1%|          | 1/184 [00:06<19:45,  6.48s/ examples]Map (num_proc=10):  72%|███████▏  | 132/184 [00:06<00:01, 27.71 examples/s]Map (num_proc=10): 100%|██████████| 184/184 [00:08<00:00, 20.80 examples/s]
Map (num_proc=10):   0%|          | 0/46 [00:00<?, ? examples/s]Map (num_proc=10):  11%|█         | 5/46 [00:01<00:11,  3.49 examples/s]Map (num_proc=10): 100%|██████████| 46/46 [00:03<00:00, 12.96 examples/s]
2023-11-21 13:14:23 - INFO :       Start Backwarding in iterative steps = 0...
2023-11-21 13:17:36 - INFO :       Loss = 17.516345977783203
2023-11-21 13:24:08 - INFO :       After Iter 1/1, #parameters: 5726666201
2023-11-21 13:24:08 - INFO :       #Param before: 6738415616, #Param after: 5726666201, Ratio = 84.9854%
2023-11-21 13:24:25 - INFO :       anachronisms: Total Sparsity 1.3592782846518406e-06
2023-11-21 13:24:25 - INFO :       
==================Finish================

2023-11-21 13:24:25 - INFO :       Memory Requirement: 0.0 MiB

2023-11-21 13:24:25 - INFO :       
********************************************************************************************************************************************************************************************************

2023-11-21 13:24:25 - INFO :       DATASET: tasksource/bigbench analogical_similarity
******************************
Generating Samples
******************************
Prepare Validation Dataset
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:01<00:01,  1.74s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.12s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.21s/it]
2023-11-21 13:24:28 - INFO :       Use taylor pruner...
2023-11-21 13:24:32 - INFO :       Start Pruning
******************************
Loading Dataset
Map (num_proc=10):   0%|          | 0/259 [00:00<?, ? examples/s]Map (num_proc=10):  10%|█         | 26/259 [00:01<00:11, 19.48 examples/s]Map (num_proc=10): 100%|██████████| 259/259 [00:03<00:00, 77.26 examples/s]
Map (num_proc=10):   0%|          | 0/64 [00:00<?, ? examples/s]Map (num_proc=10):  11%|█         | 7/64 [00:01<00:11,  5.17 examples/s]Map (num_proc=10): 100%|██████████| 64/64 [00:03<00:00, 18.69 examples/s]
2023-11-21 13:25:38 - INFO :       Start Backwarding in iterative steps = 0...
2023-11-21 13:28:53 - INFO :       Loss = 1.2611767053604126
2023-11-21 13:35:34 - INFO :       After Iter 1/1, #parameters: 5726666201
2023-11-21 13:35:34 - INFO :       #Param before: 6738415616, #Param after: 5726666201, Ratio = 84.9854%
2023-11-21 13:35:43 - INFO :       analogical_similarity: Total Sparsity 1.3498300196068071e-06
2023-11-21 13:35:43 - INFO :       
==================Finish================

2023-11-21 13:35:43 - INFO :       Memory Requirement: 0.0 MiB

2023-11-21 13:35:43 - INFO :       
********************************************************************************************************************************************************************************************************

2023-11-21 13:35:43 - INFO :       DATASET: tasksource/bigbench analytic_entailment
******************************
Generating Samples
******************************
Prepare Validation Dataset
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.32s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:34<00:00, 19.80s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:34<00:00, 17.18s/it]
2023-11-21 13:36:19 - INFO :       Use taylor pruner...
2023-11-21 13:36:24 - INFO :       Start Pruning
******************************
Loading Dataset
Map (num_proc=10):   0%|          | 0/54 [00:00<?, ? examples/s]Map (num_proc=10):  11%|█         | 6/54 [00:01<00:12,  3.94 examples/s]Map (num_proc=10): 100%|██████████| 54/54 [00:03<00:00, 14.80 examples/s]
Map (num_proc=10):   0%|          | 0/16 [00:00<?, ? examples/s]Map (num_proc=10):  12%|█▎        | 2/16 [00:01<00:10,  1.39 examples/s]Map (num_proc=10):  88%|████████▊ | 14/16 [00:03<00:00,  3.81 examples/s]Map (num_proc=10): 100%|██████████| 16/16 [00:06<00:00,  2.66 examples/s]
2023-11-21 13:37:33 - INFO :       Start Backwarding in iterative steps = 0...
2023-11-21 13:40:47 - INFO :       Loss = 16.395156860351562
2023-11-21 13:47:28 - INFO :       After Iter 1/1, #parameters: 5726666201
2023-11-21 13:47:28 - INFO :       #Param before: 6738415616, #Param after: 5726666201, Ratio = 84.9854%
2023-11-21 13:47:44 - INFO :       analytic_entailment: Total Sparsity 1.3525554806774898e-06
2023-11-21 13:47:44 - INFO :       
==================Finish================

2023-11-21 13:47:44 - INFO :       Memory Requirement: 0.0 MiB

2023-11-21 13:47:44 - INFO :       
********************************************************************************************************************************************************************************************************

2023-11-21 13:47:44 - INFO :       DATASET: tasksource/bigbench arithmetic
******************************
Generating Samples
******************************
Prepare Validation Dataset
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:33<00:33, 33.35s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:34<00:00, 14.30s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:34<00:00, 17.16s/it]
2023-11-21 13:48:20 - INFO :       Use taylor pruner...
2023-11-21 13:48:23 - INFO :       Start Pruning
******************************
Loading Dataset
Map (num_proc=10):   0%|          | 0/12019 [00:00<?, ? examples/s]Map (num_proc=10):   2%|▏         | 285/12019 [00:01<01:05, 179.98 examples/s]Map (num_proc=10):  58%|█████▊    | 7008/12019 [00:01<00:00, 5714.38 examples/s]Map (num_proc=10):  94%|█████████▍| 11280/12019 [00:01<00:00, 9603.94 examples/s]Map (num_proc=10): 100%|██████████| 12019/12019 [00:03<00:00, 3095.81 examples/s]
Map (num_proc=10):   0%|          | 0/3004 [00:00<?, ? examples/s]Map (num_proc=10):  10%|█         | 301/3004 [00:01<00:13, 197.80 examples/s]Map (num_proc=10): 100%|██████████| 3004/3004 [00:03<00:00, 827.32 examples/s]
2023-11-21 13:50:10 - INFO :       Start Backwarding in iterative steps = 0...
2023-11-21 13:53:24 - INFO :       Loss = 13.250375747680664
2023-11-21 13:59:59 - INFO :       After Iter 1/1, #parameters: 5726666201
2023-11-21 13:59:59 - INFO :       #Param before: 6738415616, #Param after: 5726666201, Ratio = 84.9854%
2023-11-21 14:00:16 - INFO :       arithmetic: Total Sparsity 1.3583697976282797e-06
2023-11-21 14:00:16 - INFO :       
==================Finish================

2023-11-21 14:00:16 - INFO :       Memory Requirement: 0.0 MiB

2023-11-21 14:00:16 - INFO :       
********************************************************************************************************************************************************************************************************

2023-11-21 14:00:16 - INFO :       DATASET: tasksource/bigbench authorship_verification
******************************
Generating Samples
******************************
Prepare Validation Dataset
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:01<00:01,  1.86s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.30s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.38s/it]
2023-11-21 14:00:20 - INFO :       Use taylor pruner...
2023-11-21 14:00:26 - INFO :       Start Pruning
******************************
Loading Dataset
Map (num_proc=10):   0%|          | 0/704 [00:00<?, ? examples/s]Map (num_proc=10):   0%|          | 1/704 [00:05<1:06:46,  5.70s/ examples]Map (num_proc=10):   2%|▏         | 14/704 [00:05<03:30,  3.27 examples/s] Map (num_proc=10):   4%|▍         | 27/704 [00:06<01:45,  6.41 examples/s]Map (num_proc=10):  15%|█▍        | 105/704 [00:09<00:32, 18.60 examples/s]Map (num_proc=10):  21%|██        | 145/704 [00:09<00:19, 28.87 examples/s]Map (num_proc=10):  40%|████      | 284/704 [00:11<00:10, 41.29 examples/s]Map (num_proc=10): 100%|██████████| 704/704 [00:13<00:00, 50.53 examples/s]
Map (num_proc=10):   0%|          | 0/176 [00:00<?, ? examples/s]Map (num_proc=10):   1%|          | 1/176 [00:03<09:38,  3.30s/ examples]Map (num_proc=10):   7%|▋         | 12/176 [00:03<00:35,  4.68 examples/s]Map (num_proc=10):  14%|█▎        | 24/176 [00:05<00:32,  4.74 examples/s]Map (num_proc=10): 100%|██████████| 176/176 [00:08<00:00, 21.69 examples/s]
2023-11-21 14:02:29 - INFO :       Start Backwarding in iterative steps = 0...
2023-11-21 14:05:43 - INFO :       Loss = 2.4694721698760986
2023-11-21 14:12:17 - INFO :       After Iter 1/1, #parameters: 5726666201
2023-11-21 14:12:17 - INFO :       #Param before: 6738415616, #Param after: 5726666201, Ratio = 84.9854%
2023-11-21 14:12:34 - INFO :       authorship_verification: Total Sparsity 1.3574613106047188e-06
2023-11-21 14:12:34 - INFO :       
==================Finish================

2023-11-21 14:12:34 - INFO :       Memory Requirement: 0.0 MiB

2023-11-21 14:12:34 - INFO :       
********************************************************************************************************************************************************************************************************

2023-11-21 14:12:34 - INFO :       DATASET: tasksource/bigbench bbq_lite_json
******************************
Generating Samples
******************************
Prepare Validation Dataset
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:01<00:01,  1.83s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.44s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.50s/it]
2023-11-21 14:12:54 - INFO :       Use taylor pruner...
2023-11-21 14:12:57 - INFO :       Start Pruning
******************************
Loading Dataset
Map (num_proc=10):   0%|          | 0/12866 [00:00<?, ? examples/s]Map (num_proc=10):   3%|▎         | 364/12866 [00:01<00:49, 253.67 examples/s]Map (num_proc=10):  51%|█████     | 6559/12866 [00:01<00:01, 5819.84 examples/s]Map (num_proc=10):  80%|████████  | 10337/12866 [00:04<00:01, 2504.38 examples/s]Map (num_proc=10):  98%|█████████▊| 12579/12866 [00:06<00:00, 1549.49 examples/s]Map (num_proc=10): 100%|██████████| 12866/12866 [00:09<00:00, 1424.13 examples/s]
Map (num_proc=10):   0%|          | 0/3210 [00:00<?, ? examples/s]Map (num_proc=10):   9%|▊         | 279/3210 [00:01<00:15, 187.42 examples/s]Map (num_proc=10):  86%|████████▌ | 2756/3210 [00:01<00:00, 2268.78 examples/s]Map (num_proc=10): 100%|██████████| 3210/3210 [00:04<00:00, 781.03 examples/s] 
2023-11-21 14:14:55 - INFO :       Start Backwarding in iterative steps = 0...
******************************
Generating Samples
******************************
Prepare Validation Dataset
Traceback (most recent call last):
  File "/home/bhandk/MLNeuron/LLM-Pruner/hf_prune.py", line 181, in <module>
    main(args)
  File "/home/bhandk/MLNeuron/LLM-Pruner/hf_prune.py", line 120, in main
    distribution =compute_single(logger,dataset_list,args)
  File "/home/bhandk/MLNeuron/LLM-Pruner/compute_single.py", line 235, in compute_single
  File "/home/bhandk/miniconda3/envs/MLNeuron/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
  File "/home/bhandk/MLNeuron/LLM-Pruner/LLMPruner/models/hf_llama/modeling_llama.py", line 689, in forward
    outputs = self.model(
  File "/home/bhandk/miniconda3/envs/MLNeuron/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/bhandk/MLNeuron/LLM-Pruner/LLMPruner/models/hf_llama/modeling_llama.py", line 579, in forward
    layer_outputs = decoder_layer(
  File "/home/bhandk/miniconda3/envs/MLNeuron/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/bhandk/MLNeuron/LLM-Pruner/LLMPruner/models/hf_llama/modeling_llama.py", line 307, in forward
    hidden_states = self.mlp(hidden_states)
  File "/home/bhandk/miniconda3/envs/MLNeuron/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/bhandk/MLNeuron/LLM-Pruner/LLMPruner/models/hf_llama/modeling_llama.py", line 158, in forward
    return self.down_proj(self.act_fn(self.gate_proj(x)) * self.up_proj(x))
  File "/home/bhandk/miniconda3/envs/MLNeuron/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/bhandk/miniconda3/envs/MLNeuron/lib/python3.9/site-packages/torch/nn/modules/linear.py", line 114, in forward
    return F.linear(input, self.weight, self.bias)
KeyboardInterrupt
Error in atexit._run_exitfuncs:
Traceback (most recent call last):
  File "/home/bhandk/miniconda3/envs/MLNeuron/lib/python3.9/weakref.py", line 631, in _exitfunc
    @classmethod
KeyboardInterrupt
